â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘              PRODUCTION LIST MODULE - COMPLETE INSTALLATION GUIDE            â•‘
â•‘                         C4Factory Manufacturing System                       â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ WHAT THIS MODULE DOES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

This implements a complete manufacturing workflow that solves these problems:

âœ… Work Order Items can be EDITED before submit (not locked to BOM)
âœ… Production List created from Work Order with BALANCE quantity tracking
âœ… Stock Entries created from Production List (NOT from BOM directly)
âœ… PARTIAL Stock Entries supported (transfer materials in batches)
âœ… AUTO STATUS updates (Open â†’ In Progress â†’ Completed)
âœ… Balance tracking (what's required vs what's already transferred)

ğŸ“Š WORKFLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. CREATE WORK ORDER
   â””â”€â†’ Edit required_items if needed (add/remove/change quantities)
   â””â”€â†’ Submit Work Order

2. CREATE PRODUCTION LIST from Work Order
   â””â”€â†’ Shows BALANCE quantities (Required - Already Transferred)
   â””â”€â†’ Select which items to include (partial or all)
   â””â”€â†’ Submit Production List
   â””â”€â†’ Status: "Open"

3. CREATE STOCK ENTRY from Production List  
   â””â”€â†’ Transfer materials based on PL items (NOT BOM)
   â””â”€â†’ Can transfer PARTIAL quantities
   â””â”€â†’ Submit Stock Entry
   â””â”€â†’ Production List auto-updates: "In Progress"

4. REPEAT Step 3 until all items transferred
   â””â”€â†’ When balance = 0, Production List status = "Completed"

5. CREATE MANUFACTURE Stock Entry
   â””â”€â†’ Finish production and move to FG Warehouse


ğŸš€ INSTALLATION STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: RUN THE AUTO-GENERATOR SCRIPT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

The file "generate_all_files.py" has been created in your project root.
This script will automatically create ALL necessary files.

Open Command Prompt or PowerShell and run:

cd d:\C4erp-APP\c4factory2
python generate_all_files.py

This will create:
  âœ“ 2 DocTypes (Production List + Production List Item)
  âœ“ Python controllers with full logic
  âœ“ API methods for creating PL and Stock Entries
  âœ“ Hooks for auto-status updates
  âœ“ Custom field patch for Stock Entry
  âœ“ 10+ files total


STEP 2: UPDATE HOOKS.PY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

The hooks.py file has ALREADY BEEN UPDATED with:
  âœ“ Production List hooks added to Stock Entry events
  âœ“ Custom field patch added to patches list

No manual action needed - already done!


STEP 3: RUN DATABASE MIGRATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Navigate to your bench directory and run:

cd /path/to/your/bench
bench --site [your-site-name] migrate

This will:
  âœ“ Create Production List doctype in database
  âœ“ Create Production List Item doctype
  âœ“ Add 'production_list' custom field to Stock Entry
  âœ“ Run all patches


STEP 4: RESTART BENCH
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

bench restart

Or if using supervisor:

sudo supervisorctl restart all


STEP 5: CLEAR CACHE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

bench --site [your-site-name] clear-cache


ğŸ§ª TESTING THE WORKFLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TEST 1: Create Work Order
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Go to Manufacturing â†’ Work Order â†’ New
2. Select Item and BOM
3. Set Quantity
4. Before Submit: You can edit "Required Items" table
   - Add new items
   - Remove items
   - Change quantities
5. Submit Work Order


TEST 2: Create Production List
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Open the Work Order you just created
2. Click Actions â†’ Create â†’ Production List
   (You need to add this button via Customize Form or use API directly)
3. Or use Python console in Frappe:

   frappe.call({
       method: "c4factory.c4_manufacturing.doctype.production_list.production_list.create_production_list_from_work_order",
       args: {
           work_order: "MFG-WO-2025-00001"  // Your WO name
       },
       callback: function(r) {
           frappe.set_route("Form", "Production List", r.message.name);
       }
   });

4. Review items with balance quantities
5. Submit Production List
6. Status should be "Open"


TEST 3: Create Stock Entry from Production List
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Open the Production List
2. Use Python console:

   frappe.call({
       method: "c4factory.api.production_list_stock.make_stock_entry_from_production_list",
       args: {
           production_list: "PL-2025-00001"  // Your PL name
       },
       callback: function(r) {
           var se = frappe.model.sync(r.message);
           frappe.set_route("Form", "Stock Entry", se[0].name);
       }
   });

3. Review Stock Entry (items from PL, not BOM)
4. Submit Stock Entry
5. Go back to Production List
6. Status should now be "In Progress"
7. transferred_qty updated, balance_qty reduced


TEST 4: Partial Transfer
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Repeat TEST 3 with partial quantities:

frappe.call({
    method: "c4factory.api.production_list_stock.make_stock_entry_from_production_list",
    args: {
        production_list: "PL-2025-00001",
        qty_dict: {"ITEM-001": 5, "ITEM-002": 3}  // Partial quantities
    },
    callback: function(r) {
        var se = frappe.model.sync(r.message);
        frappe.set_route("Form", "Stock Entry", se[0].name);
    }
});


TEST 5: Complete Production List
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Continue creating Stock Entries until all balance_qty = 0
Production List status should automatically change to "Completed"


ğŸ“ FILES CREATED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

c4factory/
â”œâ”€â”€ c4_manufacturing/
â”‚   â”œâ”€â”€ doctype/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ production_list/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ production_list.json          (DocType definition)
â”‚   â”‚   â”‚   â”œâ”€â”€ production_list.py            (Controller with full logic)
â”‚   â”‚   â”‚   â””â”€â”€ test_production_list.py
â”‚   â”‚   â””â”€â”€ production_list_item/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ production_list_item.json     (Child table definition)
â”‚   â”‚       â”œâ”€â”€ production_list_item.py
â”‚   â”‚       â””â”€â”€ test_production_list_item.py
â”‚   â””â”€â”€ production_list_hooks.py              (Event handlers)
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ production_list_stock.py              (Stock Entry creation API)
â””â”€â”€ patches/
    â””â”€â”€ v1_0/
        â””â”€â”€ setup_stock_entry_custom_fields.py (Adds production_list field)


ğŸ”§ API METHODS AVAILABLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. create_production_list_from_work_order(work_order, items=None)
   - Creates PL from WO with balance quantities
   - Args: work_order (str), items (optional list of item codes)

2. make_stock_entry_from_production_list(production_list, qty_dict=None)
   - Creates Stock Entry from PL (not BOM)
   - Args: production_list (str), qty_dict (optional {item: qty})

3. get_production_list_items_with_balance(production_list)
   - Returns items that still have balance > 0
   - Args: production_list (str)

4. production_list.update_transferred_qty()
   - Recalculates transferred quantities from Stock Entries
   - Auto-updates status


ğŸ¨ CUSTOMIZATION OPTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ADD BUTTONS TO WORK ORDER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Go to: Customize Form â†’ Work Order
2. Add Custom Button:
   - Label: "Create Production List"
   - Action: Run this JS:

   frappe.call({
       method: "c4factory.c4_manufacturing.doctype.production_list.production_list.create_production_list_from_work_order",
       args: { work_order: cur_frm.doc.name },
       callback: function(r) {
           frappe.model.sync(r.message);
           frappe.set_route("Form", "Production List", r.message.name);
       }
   });


ADD BUTTONS TO PRODUCTION LIST:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Go to: Customize Form â†’ Production List
2. Add Custom Button:
   - Label: "Create Stock Entry"
   - Action: Run this JS:

   frappe.call({
       method: "c4factory.api.production_list_stock.make_stock_entry_from_production_list",
       args: { production_list: cur_frm.doc.name },
       callback: function(r) {
           var se = frappe.model.sync(r.message);
           frappe.set_route("Form", "Stock Entry", se[0].name);
       }
   });


ğŸ“š TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ISSUE: "Module C4 Manufacturing not found"
SOLUTION: Run: bench --site [site] migrate

ISSUE: "ProductionList not found"
SOLUTION: Clear cache: bench --site [site] clear-cache

ISSUE: "production_list field not found in Stock Entry"
SOLUTION: Run migrate again, check patches executed

ISSUE: Status not updating automatically
SOLUTION: Check hooks.py has production_list_hooks in Stock Entry events

ISSUE: Can't create Stock Entry from PL
SOLUTION: Ensure PL is submitted (docstatus = 1)


âœ… SUCCESS INDICATORS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

You'll know it's working when:

1. âœ“ Production List appears in Manufacturing module
2. âœ“ You can create PL from Work Order
3. âœ“ PL shows items with balance quantities
4. âœ“ Stock Entry has "Production List" field
5. âœ“ Creating SE from PL (not BOM) works
6. âœ“ PL status updates after SE submission
7. âœ“ Balance quantities decrease after each transfer
8. âœ“ Status changes to "Completed" when balance = 0


ğŸ“ SUPPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If you encounter issues:

1. Check error logs: bench --site [site] console
2. Verify all files were created by generator script
3. Confirm migrations ran successfully
4. Test each step of workflow independently


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            END OF INSTALLATION GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
